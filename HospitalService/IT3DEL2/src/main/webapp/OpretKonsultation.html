<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Opret konsultation</title>
    <link rel="stylesheet" type="text/css" href="index.css">
    <link rel="stylesheet" type="text/css" href="rekcss.css">


<script>
    async function opretKonsultation(){

        let form = document.getElementById("aftaleform");
        let formData = new FormData(form)
        let patientJson = Object.fromEntries(formData);
        let res = await fetch("rest/aftaler", {
            method:"POST",
            body: JSON.stringify(patientJson),
            headers:{
               'content-type':"application/json",
                "authorization": "Bearer " + localStorage.getItem("token")
            }
        })

    }

    async function hentKonsultation(){
            let result = await fetch("rest/aftaler", {
                    headers: {
                        "authorization": "Bearer " + localStorage.getItem("token")
                    }
                }
                );
            console.log(result.status)
            if (result.status!=200){
            alert("noget gik galt!");
        }
        let json = await result.json();
        console.log(json)

        let listelements =""
        json.forEach(function(element){
            listelements +=("<li>"+element.date+"</li>")
        })

        let list = document.getElementById("aftaler");
        list.innerHTML=listelements
    }

    async function Logud(){
        localStorage.setItem("token"," ");
        window.location.href="index.html"

    }

</script>

</head>
<body>
<!--
HER LIGGER HEADER-KODEN :)
div class="header" id="myHeader">
    <u class="underlineHeader" color="dodgerblue"><text class="header1">Sundhedsplatformen 2.0</text></u><br>
    <text class="header2">Elektronisk patient journal</text><br>
    <text class="header3">Anno 2021</text><br>
    <p><button id="idButton" class="button1" >Logud</button></p>
</div>
-->
<div class="header" id="myHeader">
    <u class="underlineHeader"><text class="header1">Sundhedsplatformen 2.0</text></u><br>
    <text class="header2">Elektronisk patient journal</text><br>
    <text class="header3">Anno 2021</text><br>
    <p><a><input type="button" id="LogudButton" onclick="Logud()" class="button1" value="Log ud"></a></p>

    <!--<p><button id="idButton2" class="button1">Gem</button></p>-->
</div>

<div id="opretkonsdiv">
    <div id="opretkonsoverskrift">
        <p class="overskriftside"> Opret konsultation</p>
    </div>
    <div>

        <form id="aftaleform">
            <input type="date" name="date">
            <input type="text" name="cpr" placeholder="CPR-nummer">
        </form>

        <br>

        <button onclick="opretKonsultation();">Opret konsultation</button>
        <br>
        <br>
        <button onclick="hentKonsultation();">Hent konsultation</button>
    </div>
    <br>
    <br>
    <div>
        <div class="tekstoverskrift">
            Konsultationer i databasen
        </div>
        <ul id="aftaler">
        </ul>
    </div>
</div>
</body>
</html>